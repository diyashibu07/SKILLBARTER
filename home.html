<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SkillBarter - Home</title>

<style>
*{
    box-sizing:border-box;
}

body{
    margin:0;
    font-family: "Segoe UI", Arial, sans-serif;
    background:
        linear-gradient(rgba(15,15,30,0.75),rgba(15,15,30,0.75)),
        url("https://images.pexels.com/photos/4348401/pexels-photo-4348401.jpeg");
    background-size:cover;
    background-position:center;
    background-attachment:fixed;
    color:#fff;
}

/* ---------- TOP BAR ---------- */

.topbar{
    position:fixed;
    top:0;
    width:100%;
    padding:14px 28px;
    backdrop-filter: blur(10px);
    background:rgba(255,255,255,0.08);
    border-bottom:1px solid rgba(255,255,255,0.15);
    display:flex;
    justify-content:space-between;
    align-items:center;
    z-index:10;
}

.topbar a{
    color:white;
    text-decoration:none;
    margin-right:15px;
    font-weight:600;
    opacity:0.9;
}

.topbar a:hover{
    opacity:1;
}

.topbar-right{
    display:flex;
    align-items:center;
}

.credit{
    background:linear-gradient(135deg,#ffd86f,#f6c453);
    color:#222;
    padding:6px 14px;
    border-radius:20px;
    font-weight:700;
    margin-left:10px;
}

.dashboard-icon{
    font-size:20px;
    cursor:pointer;
    margin-left:10px;
}

/* ---------- HOME ---------- */

.home{
    min-height:100vh;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    text-align:center;
    padding-top:70px;
}

.home h1{
    font-size:48px;
    margin-bottom:10px;
}

.home h2{
    font-weight:400;
    opacity:0.85;
}

.home button{
    margin:15px 8px 0 8px;
    padding:12px 26px;
    border:none;
    border-radius:25px;
    background:linear-gradient(135deg,#6a7bff,#7f5ae0);
    color:white;
    font-weight:600;
    cursor:pointer;
}

/* ---------- PAGES ---------- */

.page{
    display:none;
    padding:110px 20px 40px;
    min-height:100vh;
}

/* Glass card */

.card{
    background:rgba(255,255,255,0.12);
    backdrop-filter: blur(14px);
    padding:35px;
    border-radius:18px;
    max-width:900px;
    margin:auto;
    color:#fff;
    border:1px solid rgba(255,255,255,0.18);
}

.card h2,h3{
    margin-top:0;
}

input,textarea{
    width:100%;
    padding:12px 14px;
    margin:12px 0;
    border-radius:10px;
    border:none;
    outline:none;
    font-size:15px;
}

/* buttons */

button.action{
    padding:10px 20px;
    background:linear-gradient(135deg,#6a7bff,#7f5ae0);
    color:white;
    border:none;
    border-radius:20px;
    cursor:pointer;
    font-weight:600;
}

button.action:disabled{
    opacity:0.5;
    cursor:not-allowed;
}

.back{
    margin-top:20px;
    background:rgba(255,255,255,0.25);
    color:#222;
}

/* ---------- DASHBOARD ---------- */

.stat{
    display:flex;
    gap:15px;
    margin-bottom:20px;
    flex-wrap:wrap;
}

.stat div{
    background:rgba(255,255,255,0.85);
    color:#222;
    padding:12px 18px;
    border-radius:14px;
    font-weight:600;
}

.list-box ul{
    padding-left:20px;
}

/* ---------- SKILL GRID ---------- */

.skill-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
    gap:15px;
    margin-top:15px;
}

.skill-card{
    background:rgba(255,255,255,0.9);
    padding:15px;
    border-radius:16px;
    color:#222;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
}

.skill-card h4{
    margin:0 0 6px 0;
    color:#5a5ce6;
}

.skill-card p{
    font-size:13px;
    color:#555;
}

.delete-btn{
    background:#e74c3c;
    color:white;
    border:none;
    border-radius:8px;
    padding:4px 10px;
    margin-left:8px;
    cursor:pointer;
    font-size:12px;
}
</style>
</head>

<body>

<div class="topbar">
    <div id="welcomeUser">SKILLHUB</div>

    <div class="topbar-right">
        <a href="login.html">Login</a>
        <a href="register.html">Register</a>

        <span class="dashboard-icon" title="Dashboard" onclick="openDashboard()">ðŸ‘¤</span>

        <div class="credit">ðŸ’° Credits: <span id="creditCount">0</span></div>
    </div>
</div>

<div id="home" class="home">
    <h1>Welcome to SkillBarter</h1>
    <h2>Where you become Teachers and Students</h2>

    <div>
        <button onclick="openTeacher()">MENTOR</button>
        <button onclick="openStudent()">LEARNER</button>
    </div>
</div>

<!-- ================= TEACHER PAGE ================= -->

<div id="teacherPage" class="page">
    <div class="card">
        <h2>Teach a Skill</h2>

        <input type="text" id="teachTitle" placeholder="Enter skill title">

        <textarea id="teachContent" rows="5"
        placeholder="Write what you will teach"></textarea>

        <label><b>Upload material (PDF / Image / File)</b></label>
        <input type="file" id="teachFile">

        <button class="action" onclick="publishSkill()">Publish Skill</button>

        <p id="teachMsg"></p>

        <button class="action back" onclick="goHome()">Back</button>
    </div>
</div>

<!-- ================= STUDENT PAGE ================= -->

<div id="studentPage" class="page">
    <div class="card">
        <h2>Learn a Skill</h2>

        <button class="action" onclick="loadSkills()">Load Available Skills</button>

        <div id="skillGrid" class="skill-grid"></div>

        <div id="learnArea" style="margin-top:20px;"></div>
        <p id="learnMsg"></p>

        <button class="action back" onclick="goHome()">Back</button>
    </div>
</div>

<!-- ================= DASHBOARD PAGE ================= -->

<div id="dashboardPage" class="page">
    <div class="card">
        <h2>My Dashboard</h2>

        <div class="stat">
            <div>User: <span id="dashName">Guest</span></div>
            <div>Credits: <span id="dashCredits">0</span></div>
            <div>Taught Skills: <span id="dashTaught">0</span></div>
            <div>Learned Skills: <span id="dashLearned">0</span></div>
        </div>

        <div class="list-box">
            <h3>Taught Skills (Mentor only can delete)</h3>
            <ul id="dashTaughtList"></ul>
        </div>

        <div class="list-box">
            <h3>Completed (Learned) Skills</h3>
            <ul id="dashLearnedList"></ul>
        </div>

        <button class="action back" onclick="goHome()">Back</button>
    </div>
</div>

<script>

/* ========= LOAD STORAGE ========= */

let skills = JSON.parse(localStorage.getItem("skills")) || [];
let learnedSkills = JSON.parse(localStorage.getItem("learnedSkills")) || [];
let credits = parseInt(localStorage.getItem("credits")) || 0;

creditCount.innerText = credits;

/* ========= HELPERS ========= */

function saveSkills(){
    localStorage.setItem("skills", JSON.stringify(skills));
}

function saveLearned(){
    localStorage.setItem("learnedSkills", JSON.stringify(learnedSkills));
}

function saveCredits(){
    localStorage.setItem("credits", String(credits));
}

/* ========= NAVIGATION ========= */

function hideAll(){
    home.style.display="none";
    teacherPage.style.display="none";
    studentPage.style.display="none";
    dashboardPage.style.display="none";
}

function openTeacher(){ hideAll(); teacherPage.style.display="block"; }
function openStudent(){ hideAll(); studentPage.style.display="block"; }
function openDashboard(){ hideAll(); dashboardPage.style.display="block"; updateDashboard(); }
function goHome(){ hideAll(); home.style.display="flex"; }

/* ========= DASHBOARD ========= */

function updateDashboard(){

    dashName.innerText = "User";
    dashCredits.innerText = credits;
    dashTaught.innerText = skills.length;
    dashLearned.innerText = learnedSkills.length;

    dashTaughtList.innerHTML = "";
    dashLearnedList.innerHTML = "";

    if(skills.length === 0){
        dashTaughtList.innerHTML = "<li>No skills taught yet.</li>";
    }else{
        skills.forEach((s,index)=>{
            const li = document.createElement("li");
            li.innerHTML = `
                ${s.title}
                <button class="delete-btn" onclick="deleteSkill(${index})">
                    Delete
                </button>
            `;
            dashTaughtList.appendChild(li);
        });
    }

    if(learnedSkills.length === 0){
        dashLearnedList.innerHTML = "<li>No skills learned yet.</li>";
    }else{
        learnedSkills.forEach(s=>{
            const li = document.createElement("li");
            li.textContent = s.title;
            dashLearnedList.appendChild(li);
        });
    }
}

/* ========= DELETE ========= */

function deleteSkill(index){

    if(!confirm("Are you sure you want to delete this skill?")){
        return;
    }

    skills.splice(index,1);
    saveSkills();

    updateDashboard();
    loadSkills();
}

/* ========= TEACH ========= */

function publishSkill(){

    const title   = teachTitle.value.trim();
    const content = teachContent.value.trim();
    const fileInput = teachFile;

    if(title === "" || content === ""){
        teachMsg.innerText = "Please enter title and content.";
        return;
    }

    if(fileInput.files.length === 0){
        teachMsg.innerText = "Please upload a file for this skill.";
        return;
    }

    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.onload = function(e){

        skills.push({
            title,
            content,
            fileName: file.name,
            fileData: e.target.result
        });

        saveSkills();

        credits++;
        saveCredits();
        creditCount.innerText = credits;

        teachMsg.innerText = "Skill published! +1 Credit earned ðŸ’°";

        teachTitle.value="";
        teachContent.value="";
        fileInput.value="";

        updateDashboard();
    };

    reader.readAsDataURL(file);
}

/* ========= LEARN ========= */

function loadSkills(){

    skills = JSON.parse(localStorage.getItem("skills")) || [];
    const grid = skillGrid;
    grid.innerHTML = "";

    if(skills.length === 0){
        grid.innerHTML = "<p>No skills available.</p>";
        return;
    }

    skills.forEach((s,index)=>{

        const card = document.createElement("div");
        card.className = "skill-card";

        card.innerHTML = `
            <h4>${s.title}</h4>
            <p>Click learn to view details</p>
            <button class="action" ${credits<=0?"disabled":""}
                onclick="startLearning(${index})">
                Learn
            </button>
        `;

        grid.appendChild(card);
    });
}

function startLearning(i){

    if(credits <= 0){
        alert("You need credits to learn! Teach something first.");
        return;
    }

    const skill = skills[i];

    credits--;
    saveCredits();
    creditCount.innerText = credits;

    learnedSkills.push(skill);
    saveLearned();

    learnArea.innerHTML = `
        <h3>${skill.title}</h3>
        <p>${skill.content}</p>
        ${skill.fileData ?
            `<a href="${skill.fileData}" download="${skill.fileName}">
                Download material (${skill.fileName})
            </a>` : ""
        }
    `;

    learnMsg.innerText = `Learned "${skill.title}". -1 Credit`;

    updateDashboard();
    loadSkills();
}

</script>

</body>
</html>